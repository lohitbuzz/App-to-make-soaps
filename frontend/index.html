<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Moksha SOAP App</title>
<link rel="stylesheet" href="style.css" />
</head>

<body>

<header class="header">
    <img src="logo.png" alt="Moksha SOAP" class="logo" />
    <h1 class="app-title">Moksha SOAP</h1>
</header>

<!-- TAB BAR (scrollable on mobile) -->
<div class="tab-bar">
    <button class="tab-button active" id="tabAppointment">Appointment</button>
    <button class="tab-button" id="tabSurgery">Surgery</button>
    <button class="tab-button" id="tabToolbox">Toolbox</button>
    <button class="tab-button" id="tabConsult">Consult</button>
    <button class="tab-button" id="tabTransfer">Phone ‚Üí Desktop</button>
</div>

<!-- STATUS LINE -->
<div id="statusMessage" class="status-line">Ready.</div>

<!-- =============================== -->
<!-- ===== APPOINTMENT SECTION ===== -->
<!-- =============================== -->
<section id="appointmentSection">

    <!-- FILE UPLOAD (Vision-enabled) -->
    <div class="upload-block">
        <label class="upload-label">Attach photos / labs / documents:</label>
        <input type="file" id="apptFiles" multiple accept="image/*,.pdf,.txt,.doc,.docx" />
    </div>

    <h2>Appointment SOAP</h2>

    <textarea id="apptReason" placeholder="Reason for visit"></textarea>
    <textarea id="apptHistory" placeholder="History"></textarea>
    <textarea id="apptPE" placeholder="Physical Exam (data-only)"></textarea>
    <textarea id="apptDiagnostics" placeholder="Diagnostics (data-only)"></textarea>
    <textarea id="apptAssessment" placeholder="Assessment hints (optional)"></textarea>
    <textarea id="apptPlan" placeholder="Plan hints (optional)"></textarea>
    <textarea id="apptMeds" placeholder="Meds dispensed hints (optional)"></textarea>

    <button id="generateApptSoapBtn" class="primary-btn">Generate SOAP</button>

    <!-- SOAP OUTPUT -->
    <h3>SOAP Output</h3>
    <textarea id="soapOutput" class="output-box"></textarea>

    <!-- FEEDBACK BOX -->
    <textarea id="soapFeedbackInput" class="feedback-box" placeholder="Refine / improve SOAP..."></textarea>
    <button id="improveSoapBtn" class="secondary-btn">Refine SOAP</button>
    <button id="copySoapBtn" class="secondary-btn">Copy SOAP</button>

    <!-- COLLAPSIBLE RECORDER -->
    <details class="recording-panel">
        <summary>üéôÔ∏è Voice Recorder (tap to expand)</summary>

        <div class="recorder-container">
            <button id="startRecordBtn" class="record-btn">‚óè Record</button>
            <button id="sendAudioBackendBtn" class="secondary-btn">Send to Backend</button>
            <button id="sendAudioTextboxBtn" class="secondary-btn">Send to Textbox</button>

            <textarea id="recordingTranscript" placeholder="Transcript will appear here"></textarea>

            <!-- USE TRANSCRIPT CHECKBOX -->
            <label class="checkbox-line">
                <input type="checkbox" id="useTranscriptForSoap" />
                Use transcript in SOAP generation
            </label>
        </div>
    </details>

</section>

<!-- ======================== -->
<!-- ===== SURGERY UI ======= -->
<!-- ======================== -->
<section id="surgerySection" class="hidden">

    <div class="upload-block">
        <label class="upload-label">Attach photos / labs / docs:</label>
        <input type="file" id="sxFiles" multiple accept="image/*,.pdf,.txt,.doc,.docx" />
    </div>

    <h2>Surgery SOAP</h2>

    <textarea id="sxReason" placeholder="Reason for surgery"></textarea>
    <textarea id="sxHistory" placeholder="Surgical history"></textarea>
    <textarea id="sxPE" placeholder="PE (data-only)"></textarea>
    <textarea id="sxDiagnostics" placeholder="Diagnostics"></textarea>

    <!-- COLLAPSIBLE ANESTHESIA BLOCK -->
    <details class="collapsible-block">
        <summary>Anesthesia Settings</summary>

        <label>Premed Cocktail:</label>
        <select id="premedSelect">
            <option value="">Select premed...</option>
            <option value="TDK">TDK 1:1:1:1 (Cats)</option>
            <option value="Methadone+Midaz">Methadone + Midazolam</option>
            <option value="Methadone+Dex">Methadone + Dexmed</option>
            <option value="Hydro+Midaz">Hydromorphone + Midazolam</option>
            <option value="Hydro+Dex">Hydromorphone + Dexmed</option>
            <option value="BupSR">Buprenorphine SR (post-op)</option>
        </select>

        <label>Induction:</label>
        <select id="inductionSelect">
            <option value="">Select induction...</option>
            <option value="Propofol">Propofol</option>
            <option value="Alfaxan">Alfaxan</option>
            <option value="KetDiaz">Ketamine + Diazepam</option>
        </select>

        <label>Intra-op meds:</label>
        <textarea id="intraOpMeds" placeholder="Intra-op meds (optional)"></textarea>

        <label>Post-op meds:</label>
        <textarea id="postOpMeds" placeholder="Post-op meds (optional)"></textarea>
    </details>

    <textarea id="sxProcedureNotes" placeholder="Procedure notes"></textarea>
    <textarea id="sxRecovery" placeholder="Recovery notes"></textarea>
    <textarea id="sxMedsDispensed" placeholder="Meds dispensed"></textarea>

    <button id="generateSxSoapBtn" class="primary-btn">Generate Surgery SOAP</button>

    <h3>Surgery SOAP Output</h3>
    <textarea id="soapOutputSx" class="output-box"></textarea>

    <textarea id="sxFeedbackInput" class="feedback-box" placeholder="Refine surgery SOAP..."></textarea>
    <button id="sxImproveBtn" class="secondary-btn">Refine SOAP</button>

    <!-- Recorder shared across all sections -->
    <details class="recording-panel">
        <summary>üéôÔ∏è Voice Recorder</summary>

        <div class="recorder-container">
            <button class="record-btn" id="startRecordBtnSx">‚óè Record</button>
            <button class="secondary-btn" id="sendAudioBackendBtnSx">Send to Backend</button>
            <button class="secondary-btn" id="sendAudioTextboxBtnSx">Send to Textbox</button>
            <textarea id="recordingTranscriptSx"></textarea>

            <label class="checkbox-line">
                <input type="checkbox" id="useTranscriptForSx" /> Use transcript for surgery SOAP
            </label>
        </div>
    </details>

</section>

<!-- ====================== -->
<!-- ===== TOOLBOX UI ===== -->
<!-- ====================== -->
<section id="toolboxSection" class="hidden">

    <div class="upload-block">
        <label>Upload images for Vision:</label>
        <input type="file" id="toolboxFiles" multiple accept="image/*,.pdf" />
    </div>

    <!-- Toolbox dropdown -->
    <label>Toolbox Mode:</label>
    <select id="toolboxMode">
        <option value="bloodwork">Bloodwork Summary</option>
        <option value="lab">Lab Interpretation</option>
        <option value="email">Client Email</option>
        <option value="weight">Weight Consult Tool</option>
        <option value="free">Free-form</option>
    </select>

    <textarea id="toolboxInput" placeholder="Toolbox request (optional)"></textarea>

    <button id="toolboxGenerateBtn" class="primary-btn">Generate Toolbox Output</button>

    <h3>Toolbox Output</h3>
    <textarea id="toolboxOutput" class="output-box"></textarea>

    <textarea id="toolboxFeedbackInput" class="feedback-box" placeholder="Refine or adjust output..."></textarea>
    <button id="toolboxRefineBtn" class="secondary-btn">Refine</button>

</section>

<!-- ===================== -->
<!-- ===== CONSULT UI ==== -->
<!-- ===================== -->
<section id="consultSection" class="hidden">

    <div class="upload-block">
        <label>Upload images/documents:</label>
        <input type="file" id="consultFiles" multiple accept="image/*,.pdf" />
    </div>

    <textarea id="consultMessage" placeholder="Ask a clinical question..."></textarea>
    <button id="consultAskBtn" class="primary-btn">Ask</button>

    <h3>Consult Output</h3>
    <textarea id="consultOutput" class="output-box"></textarea>

    <textarea id="consultFeedbackInput" class="feedback-box" placeholder="Refine consult output..."></textarea>
    <button id="consultRefineBtn" class="secondary-btn">Refine</button>

</section>

<!-- =========================== -->
<!-- PHONE ‚Üí DESKTOP RELAY UI  -->
<!-- =========================== -->
<section id="transferSection" class="hidden">
    <h2>Phone ‚Üí Desktop Transfer</h2>

    <p>Use your phone to upload photos or text, and they will appear here.</p>

    <div class="relay-block">
        <button id="generateRelayQR" class="primary-btn">Generate QR</button>
        <img id="relayQR" class="qr-preview" />
    </div>

    <h3>Received Content</h3>
    <textarea id="relayOutput" class="output-box"></textarea>

</section>

<script src="app.js"></script>
</body>
</html>